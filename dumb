repeat task.wait() until game:IsLoaded()

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local MarketplaceService = game:GetService("MarketplaceService")

local LocalPlayer = Players.LocalPlayer

local PlaceName = MarketplaceService:GetProductInfo(game.PlaceId).Name
if not PlaceName:lower():find("fight in a school") then
    error("This script only works in 'Fight in a School'!")
end

local AutoweaveRemote = ReplicatedStorage:WaitForChild("Autoweave", 5)
local AutoweaveEnabled = false

if not AutoweaveRemote then
    warn("Autoweave RemoteEvent not found! Check console for alternatives.")
    for _, obj in pairs(ReplicatedStorage:GetChildren()) do
        if obj:IsA("RemoteEvent") and (obj.Name:lower():find("weave") or obj.Name:lower():find("auto")) then
            print("Possible RemoteEvent match: " .. obj.Name)
        end
    end
else
    print("Autoweave RemoteEvent found! Press T to toggle.")
end

local function ToggleAutoweave(value)
    if not AutoweaveRemote then
        warn("Cannot toggle: Autoweave RemoteEvent missing!")
        return
    end
    AutoweaveRemote:FireServer(value)
    AutoweaveEnabled = value
    print("Autoweave " .. (value and "ENABLED" or "DISABLED"))
end

UserInputService.InputBegan:Connect(function(input, gameProcessedEvent)
    if not gameProcessedEvent and input.KeyCode == Enum.KeyCode.T then
        ToggleAutoweave(not AutoweaveEnabled)
    end
end)

LocalPlayer.CharacterAdded:Connect(function()
    task.wait(1)
    if AutoweaveEnabled and AutoweaveRemote then
        ToggleAutoweave(true)
        print("Autoweave re-enabled after respawn.")
    end
end)

spawn(function()
    while true do
        task.wait(60)
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.Jump = true
            task.wait(0.1)
            LocalPlayer.Character.Humanoid.Jump = false
        end
    end
end)

print("Autoweave Script Loaded! Press T to toggle Autoweave.")

-- Fight in a School AutoWeave Script (Minimalist)
-- Features: AutoWeave (dodge around nearest enemy)
-- Toggle: Press T
-- Use at own risk!

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

-- Config
local Config = {
    WeaveSpeed = 16,  -- Dodge speed (higher = faster)
    WeaveDistance = 5,  -- Side-to-side distance
    Range = 20,  -- Max distance to target enemy
    Enabled = false
}

local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local RootPart = Character:WaitForChild("HumanoidRootPart")

-- Find Nearest Enemy
local function GetNearestEnemy()
    local nearest, dist = nil, math.huge
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local distance = (RootPart.Position - player.Character.HumanoidRootPart.Position).Magnitude
            if distance < dist then
                nearest = player
                dist = distance
            end
        end
    end
    return nearest
end

-- AutoWeave Loop
local weaveConnection
local function StartAutoWeave()
    if Config.Enabled then
        weaveConnection = RunService.Heartbeat:Connect(function()
            local target = GetNearestEnemy()
            if target and target.Character and (RootPart.Position - target.Character.HumanoidRootPart.Position).Magnitude <= Config.Range then
                -- Weave: Side-to-side movement (sin wave for dodge)
                local time = tick()
                local offset = math.sin(time * Config.WeaveSpeed) * Config.WeaveDistance
                local targetPos = target.Character.HumanoidRootPart.Position
                local weavePos = Vector3.new(targetPos.X + offset, targetPos.Y, targetPos.Z - 5)  -- Circle behind-ish
                
                -- Apply BodyVelocity for smooth weave
                local bv = RootPart:FindFirstChild("WeaveBV") or Instance.new("BodyVelocity")
                bv.Name = "WeaveBV"
                bv.MaxForce = Vector3.new(4000, 0, 4000)
                bv.Velocity = (weavePos - RootPart.Position).Unit * 50  -- Move to weave point
                bv.Parent = RootPart
            else
                -- No target: Stop weave
                if RootPart:FindFirstChild("WeaveBV") then
                    RootPart.WeaveBV:Destroy()
                end
            end
        end)
    else
        if weaveConnection then
            weaveConnection:Disconnect()
            weaveConnection = nil
        end
        if RootPart:FindFirstChild("WeaveBV") then
            RootPart.WeaveBV:Destroy()
        end
    end
end

-- Toggle
UserInputService.InputBegan:Connect(function(input, processed)
    if processed then return end
    if input.KeyCode == Enum.KeyCode.T then
        Config.Enabled = not Config.Enabled
        StartAutoWeave()
        print("AutoWeave " .. (Config.Enabled and "ON" or "OFF"))
    end
end)

-- Reconnect on Respawn
LocalPlayer.CharacterAdded:Connect(function(newChar)
    Character = newChar
    RootPart = Character:WaitForChild("HumanoidRootPart")
    if Config.Enabled then
        wait(1)
        StartAutoWeave()
    end
end)

print("AutoWeave Loaded! Press T to toggle.")
